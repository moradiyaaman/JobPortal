@model ProviderDashboardViewModel
@{
    ViewData["Title"] = "Provider dashboard";
}
<section class="dashboard">
    <header class="mb-4">
        <h1 class="h3">Welcome back, @Model.CompanyName</h1>
        @if (!string.IsNullOrWhiteSpace(Model.CompanyDescription))
        {
            <p class="text-muted">@Model.CompanyDescription</p>
        }
        <div class="small text-muted">
            @if (!string.IsNullOrWhiteSpace(Model.CompanyLocation))
            {
                <span><strong>Location:</strong> @Model.CompanyLocation</span>
            }
            @if (!string.IsNullOrWhiteSpace(Model.CompanyWebsite))
            {
                <span class="ml-3"><strong>Website:</strong> <a href="@Model.CompanyWebsite" target="_blank" rel="noopener">@Model.CompanyWebsite</a></span>
            }
        </div>
    </header>

    <div class="row text-center mb-4">
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="display-4">@Model.ActiveJobs</div>
                    <div class="text-muted">Active jobs</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="display-4">@Model.TotalJobs</div>
                    <div class="text-muted">Total postings</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card shadow-sm">
                <div class="card-body">
                    <div class="display-4">@Model.TotalApplications</div>
                    <div class="text-muted">Applications received</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0">Recent postings</h2>
                    <a asp-area="Provider" asp-controller="Jobs" asp-action="Create" class="btn btn-sm btn-primary">New job</a>
                </div>
                <ul class="list-group list-group-flush">
                    @if (Model.RecentJobs?.Any() == true)
                    {
                        foreach (var job in Model.RecentJobs)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>@job.Title</strong>
                                    <div class="small text-muted">Posted @job.PostedAt.ToLocalTime():g â€¢ @job.ApplicationCount application(s)</div>
                                </div>
                                <span class="badge @(job.IsActive ? "badge-success" : "badge-secondary")">@(job.IsActive ? "Active" : "Paused")</span>
                            </li>
                        }
                    }
                    else
                    {
                        <li class="list-group-item text-muted">No jobs posted yet.</li>
                    }
                </ul>
            </div>
        </div>
        <div class="col-lg-6 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-header">
                    <h2 class="h5 mb-0">Recent applications</h2>
                </div>
                <ul class="list-group list-group-flush">
                    @if (Model.RecentApplications?.Any() == true)
                    {
                        foreach (var application in Model.RecentApplications)
                        {
                            <li class="list-group-item">
                                <strong>@application.ApplicantName</strong>
                                <div class="small text-muted">
                                    Applied for <a asp-area="Provider" asp-controller="Jobs" asp-action="Edit" asp-route-id="@application.JobId">@application.JobTitle</a>
                                    on @application.AppliedAt.ToLocalTime():g
                                </div>
                                <span class="badge badge-light">@application.Status</span>
                            </li>
                        }
                    }
                    else
                    {
                        <li class="list-group-item text-muted">No applications yet.</li>
                    }
                </ul>
            </div>
        </div>
    </div>
</section>
